@model Blogifier.Core.Data.Models.AdminSettingsModel
@using Blogifier.Core.Common
@using Blogifier.Core.Data.Domain
@using Blogifier.Core.Extensions
@{
    ViewData["Title"] = "Newsletter";
    Layout = ApplicationSettings.PkgSettingsLayout;

    var result = ComponentHelper.GetValue(Model.Settings, "Emails");
    var emails = (IEnumerable<Subscriber>)result;
}

<!-- Toolbar -->
<div class="bf-toolbar d-flex align-items-center">
    <label class="custom-control custom-checkbox custom-control-single mr-3">
        <input class="custom-control-input item-checkbox" type="checkbox" id="selectAll" name="selectAll">
        <span class="item-control custom-control-indicator"></span>
    </label>
    <div id="postActionButtons" class="btn-group mr-3">
        <button type="button" class="btn btn-outline-secondary btn-icon btn-sm btn-rounded" disabled="disabled" data-tooltip onclick="return newsletter.remove()" title="Remove">
            <i class="fa fa-trash"></i>
        </button>
    </div>
    <div class="loading loading-sm mr-3">
        <div class="loading-dot-1"></div>
        <div class="loading-dot-2"></div>
        <div class="loading-dot-3"></div>
    </div>
</div>
<!--/Toolbar -->

@if (emails != null && emails.Any())
{
    <ul class="bf-list d-block" aria-label="newsletter">
        @foreach (var item in emails)
        {
            <li class="bf-list-item d-flex align-items-center">
                <div class="row" style="width: 100%">
                    <div class="col-md-1">
                        <label class="bf-list-item-select custom-control custom-checkbox mr-3 my-auto">
                            <input type="checkbox" value="@item.Email" class="item-checkbox custom-control-input">
                            <span class="item-control custom-control-indicator"></span>
                        </label>
                    </div>
                    <div class="col-md-3">@item.Email</div>
                    <div class="col-md-2">@item.Browser</div>
                    <div class="col-md-2">@item.Device</div>
                    <div class="col-md-1">@item.Os</div>
                    <div class="col-md-1">@item.Ip</div>
                    <div class="col-md-2">@item.LastUpdated.ToFriendlyDateTimeString()</div>
                </div>
            </li>
        } 
    </ul>
}
else
{
    <div class="bf-list-empty">
        No subscribers found!
    </div>
}
<script>
    var root = '@Url.Content("~/")';
</script>

@section Scripts{
    <script src="~/plugins/emailer/settings.js"></script>
}